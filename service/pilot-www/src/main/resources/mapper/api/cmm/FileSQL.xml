<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mgkim.service.www.api.cmm.file.mapper.FileMapper">

  <insert id="insertFile" parameterType="FileVO">
    INSERT
      INTO MGCB404TM /* MGCB_파일정보 */ (
          SITE_TPCD
        , FILE_ID
        , ORG_FILENM
        , SAVE_FILENM
        , SAVE_FPATH
        , FILE_TPCD
        , FILE_EXT
        , FILE_SIZE
        , CKSUM
        , CRPT_YN
        , ZIP_YN
        , USE_YN
        , FIRST_REGIR_NO
        , FIRST_REGI_DTTM
        , LAST_MODFR_NO
        , LAST_MODF_DTTM
      ) VALUES (
          #{siteTpcd}
        , #{fileId}
        , #{orgFilenm}
        , #{saveFilenm}
        , #{saveFpath}
        , #{fileTpcd}
        , #{fileExt}
        , #{fileSize}
        , #{cksum}
        , #{crptYn}
        , #{zipYn}
        , 'Y'
        , #{ssuserId}
        , SYSDATE
        , #{ssuserId}
        , SYSDATE
      )
  </insert>

  <select id="selectFile" parameterType="FileVO" resultType="FileVO">
    SELECT 
           A.*
      FROM MGCB404TM A /* MGCB_파일정보 */
     WHERE A.SITE_TPCD = #{siteTpcd}
       AND A.USE_YN = 'Y'
       AND A.FILE_ID = #{fileId}
  </select>

  <select id="selectFilegroup" parameterType="FileVO" resultType="FileVO">
    SELECT 
           A.*
      FROM MGCB404TM A /* MGCB_파일정보 */
         , MGCB405TR B /* MGCB_파일그룹정보 */
     WHERE A.SITE_TPCD = #{siteTpcd}
       AND A.USE_YN = 'Y'
       AND A.SITE_TPCD = B.SITE_TPCD
       AND A.FILE_ID = B.FILE_ID
       AND B.FGRP_ID = #{fgrpId}
  </select>

  <insert id="insertFilegroup" parameterType="FileVO">
    INSERT
      INTO MGCB405TR /* MGCB_파일그룹정보 */ (
          SITE_TPCD
        , FGRP_ID
        , FILE_ID
        , FIRST_REGIR_NO
        , FIRST_REGI_DTTM
        , LAST_MODFR_NO
        , LAST_MODF_DTTM
      ) VALUES (
          #{siteTpcd}
        , #{fgrpId}
        , #{fileId}
        , #{ssuserId}
        , SYSDATE
        , #{ssuserId}
        , SYSDATE
      )
  </insert>
</mapper>